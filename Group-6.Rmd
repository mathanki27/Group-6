---
title: "Group-6"
author: "Mathanki Mehra, Anakha Prasad, Kalyla Dsouza"
date: "2024-10-08"
output:
  html_document: default
  pdf_document: default
---
# PART 1

To download a file from GitHub to R, the download.file() function can be employed. The following steps outline the procedure:

1. **Find the Raw File URL**:
   - Navigate to the desired file within the GitHub repository.
   - Click on the file and then select the "Raw" button to obtain the direct link to the file.

2. **Use download.file() in R**:
   - Utilize the download.file() function, specifying the URL of the raw file as the first argument and the destination path on the local machine as the second argument.

```{r}
# URL of the first raw file on GitHub
url <- "https://raw.githubusercontent.com/ghazkha/Assessment4/refs/heads/main/gene_expression.tsv"

# Path to save the file locally (in the current directory)
destination <- "gene_expression.tsv"

# Download the file
download.file(url, destination)

# URL of the second raw file on GitHub
url1 <- "https://raw.githubusercontent.com/ghazkha/Assessment4/refs/heads/main/growth_data.csv"

# Path to save the file locally (in the current directory)
destination <- "growth_data.csv"

# Download the file
download.file(url1, destination)

```

### Step 1
To read the gene_expression.tsv file into R and set the gene identifiers as the row names, the read.table() function can be used. Subsequently, the first six genes can be displayed using the head() function. The following code illustrates these steps:
```{r}
# Read in the gene expression data and making gene identifiers as row names
gene_expression <- read.table("gene_expression.tsv", header = TRUE, row.names = 1, sep = "\t")

# Show a table of values for the first six genes
head(gene_expression)
```

**Code Explanation:**

- header = TRUE: This tells R that the first row of the file contains the column names (i.e., headers for each column). This allows R to correctly assign the names to the data frame's columns.

- row.names = 1: This argument specifies that the first column of the data file (index 1) should be treated as row names instead of a regular data column. This means that the values in the first column will not be included as part of the data frame; instead, they will serve as labels for the rows.

- sep = "\t": This indicates that the data is tab-separated. Since the file is a .tsv (tab-separated values), this ensures that R reads the file correctly by treating each tab as a separator between columns.

By using the row.names = 1 argument, the gene identifiers from the first column are set as the row names of the gene_expression data frame. As a result, when we display the data frame using head(gene_expression), we will see the gene identifiers as the row labels.

We can also see the structure of the data frame after reading it, using str() command.

```{r}
str(gene_expression)
```

This shows the column names and the row names, allowing us to confirm that the gene identifiers are indeed set as row names. 

### Step 2
The following code is used to calculate the mean of columns as well as add a new column "mean_count" to the existing data frame. 

```{r}
# Read in the gene expression data
gene_expression <- read.table("gene_expression.tsv", header = TRUE, row.names = 1, sep = "\t")

# Calculate the mean of the counts across the columns for each gene
gene_expression$mean_count <- rowMeans(gene_expression)

# Show a table of values for the first six genes, including the new mean column
head(gene_expression)

```

**Code Explanation:**

- rowMeans(gene_expression): This function calculates the mean of the counts for each row (gene) across all the specified columns. The result is a vector containing the mean counts for each gene.

- gene_expression$mean_count <-: This assigns the calculated mean counts to a new column called mean_count in the gene_expression data frame.

- head(gene_expression): This displays the first six genes along with all their corresponding count data and the new mean column.

We can further use the View() command to visualize the data frame. By using this command we can further see the newly added column.

### Step 3
To identify the 10 genes with the highest mean expression from the gene_expression data frame, the order() function can be utilized to sort the data based on the mean_count column in descending order. Subsequently, the top 10 rows can be extracted. The following steps outline this process:
```{r}
# Read in the gene expression data
gene_expression <- read.table("gene_expression.tsv", header = TRUE, row.names = 1, sep = "\t")

# Calculate the mean of the counts across the columns for each gene
gene_expression$mean_count <- rowMeans(gene_expression)

# Get the 10 genes with the highest mean expression
top_10_genes <- gene_expression[order(-gene_expression$mean_count), ][1:10, ]

# Display the top 10 genes
top_10_genes

```
**Code Explanation:**

- order(-gene_expression$mean_count): This orders the indices of gene_expression based on the mean_count column in descending order (the negative sign - indicates descending order).

- gene_expression[...]: This uses the ordered indices to subset the gene_expression data frame, sorting the rows based on mean expression.

- [1:10, ]: This selects the first 10 rows of the sorted data frame, which correspond to the genes with the highest mean expression.

- top_10_genes: This stores the resulting data frame containing the top 10 genes, and the final line displays it.

### Step 4
The next step is to estimate the number of genes with a mean that is less than 10. This can be done with the help of the running the codes given below:

```{r}
#Find the mean count find that have mean values less than 10 
gene_expression$mean_count < 10
```

**Code Description:**

This code functions to find out the genes from the given data frame (gene_expression)which have mean values which are less than 10.with this code we can specifying to find the mean values that are less than 10 in the mean_count column  that is created in the gene_expression data frame ,and then represent it in the form of true/ false.
"true" represents that mean value is less than 10
"False " value means that the mean value is more than 10.

```{r}
# Count the number of genes with a mean expression < 10
num_genes_below_10 <- sum(gene_expression$mean_count < 10)

# Display the result
num_genes_below_10
```
**Code Explanation:**
To determine the number of genes that have mean values less than 10, we so the sum total of the categories that is done with the help of the code given above, which is 35988.
- gene_expression$mean_count < 10: This creates a logical vector where each gene's mean expression is checked to see if it's less than 10.
- sum(...): This counts the number of TRUE values in the logical vector, which corresponds to the number of genes with a mean expression less than 10.

### Step 5
This step involves the construction of the histogram which is a bar graph representation of the mean expression values .


```{r}
# Create a histogram of the mean expression values
hist(gene_expression$mean_count, 
     main = "Histogram of Mean Gene Expression Values", 
     xlab = "Mean Expression Value", 
     ylab = "Frequency", 
     col = "purple", 
     border = "black")
```

**Code Explanation:**
The code given above is used to generate a histogram of the mean expression values where in the code the function "hist" is used to produce a histogram for the specified data , that is, gene_expression. In the code the main heading for the graph and the x and y axis headings are also specified.
- hist(): This function generates the histogram.
- main =: Sets the title of the plot.
- xlab = and ylab =: Label the x-axis and y-axis.
- col = "purple": Sets the color of the bars.
- border = "black": Adds a black border to the bars for better visualization.

### Step 6
```{r}
#Import the csv file
growth_data <- read.csv("growth_data.csv")
```

**code explanation**

The code "read.csv" given above is used to import the csv file named growth_data.csv and converts it into R object , where it is saved as growth_data.

"<-" function is used to direct the output of the read.csv function to the growth_data.

```{r}
#Display the column names
colnames(growth_data)
```

**Code Explanation:**

The code given above is used to list the column names and that is done with the help of the function "colnames" after which we also specify the name of the data frame ,that is growth_data.

### Step 7
This step calculates the mean and standard deviation of tree circumference at the start and end end of the study at both sites
```{r}

#calculates the mean for the circumference over the years
colMeans(growth_data[, 3:6])
```
**Code Explanation*
"3:6" selects the columns from 3 to 6 only while "," selects all the data in the respective columns. "colMeans" is used to calculate the mean across all the data in the selected columns and rows
```{r}

#Calculates the standard deviation
apply(growth_data[, 3:6], 2,sd)
```

**Code Explanation**
 selects all data from all rows in columns 3 to 6 and calculates the standard deviation, the number 2 refers to column selection only and apply() is used to apply the sd function to each column

##Step 8
```{r}
#Creation of boxplot of tree circumference at the start and end of the study at both sites.
boxplot(growth_data[, 3:6])
```

**Code Explanation**
Code retrieves all the data from columns 3 to 6 and plots a box plot for each column

##Step 9
```{r}
#Calulates the average over the last 10 years
mean(c(growth_data[,4], growth_data[,5], growth_data[,6]))
```

**Code Explanation**
Code retrieves the data from all the rows in selected columns 4,5 and 6. These columns were selected as it contained the data for the last 10 years. The function c combines all the data together for ease of calculation and the function mean is used to calculate the mean of the selected data


### Step 10

```{r}

# Step 1: Perform a t-test comparing the growth between the two sites
t_test_result <- t.test(Growth_2010_2020 ~ Site, data = growth_data)

# Step 2: View the p-value and other test results
print(t_test_result)

```
**Code Explanation:**

- t.test: This function in R performs a t-test, which is used to test if there is a significant difference between the means of two groups.
- Growth_2010_2020 ~ Site:
  1. Growth_2010_2020 is the numeric variable representing the growth in tree circumference over the last 10 years (2010 to 2020).
  2. Site is a factor variable that indicates which site each growth observation comes from. In this case, you have two sites: "northeast" and "southwest."
  3. The formula Growth_2010_2020 ~ Site tells R to compare the Growth_2010_2020 variable between the two levels of the Site factor (northeast vs southwest).
-	data = growth_data: This specifies that both Growth_2010_2020 and Site are columns in the growth_data data frame. It tells the t.test function to look for these variables in that data frame.

**Welch Two Sample t-test:**
Welch's t-test is used here because it does not assume equal variances between the two groups, which makes it more robust in cases where the variances might differ.

The output of the Welch Two Sample t-test shows the following key points:
•	t-value: **1.8882**
•	Degrees of freedom (df): **87.978**
•	p-value: **0.06229**
Interpretation:
•	P-value: The p-value of 0.06229 is slightly above the common significance threshold of 0.05. This means that there is not enough statistical evidence at the 5% level to reject the null hypothesis that the mean 10-year growth is the same at both sites. However, the p-value is relatively close to 0.05, suggesting a potential trend towards a difference in growth between the two sites, but not at a statistically significant level.
•	Mean growth:
 o	Northeast site: 42.94 cm
 o	Southwest site: 35.49 cm

The northeast site appears to have a slightly higher average growth over the 10 years compared to the southwest site, though the difference is not statistically significant at the 5% level.

# PART 2


### Step 1

To download whole set of E. coli. coding DNA sequences, we use the following code:

```{r}
# Load the necessary package for file decompression
library("R.utils")

# Define the URL for the Escherichia coli K-12 substrain MG1655 CDS file
URL = "http://ftp.ensemblgenomes.org/pub/bacteria/release-53/fasta/bacteria_0_collection/escherichia_coli_str_k_12_substr_mg1655_gca_000005845/cds/Escherichia_coli_str_k_12_substr_mg1655_gca_000005845.ASM584v2.cds.all.fa.gz"

# Download the CDS file from the URL and save it locally as 'ecoli_cds.fa.gz'
download.file(URL, destfile = "ecoli_cds.fa.gz")

# Decompress the gzipped file to extract the fasta file (.fa)
gunzip("ecoli_cds.fa.gz")

# List all files in the current working directory to confirm successful extraction
list.files()

```

To download whole set of Bifidobacteriaceae bacterium coding DNA sequences, we use the following code:

```{r}
# Load the necessary package for file decompression
library("R.utils")

# URL for Bifidobacteriaceae bacterium CDS
URL="https://ftp.ensemblgenomes.ebi.ac.uk/pub/bacteria/release-59/fasta/bacteria_63_collection/bifidobacteriaceae_bacterium_wp012_gca_003585625/cds/Bifidobacteriaceae_bacterium_wp012_gca_003585625.ASM358562v1.cds.all.fa.gz"

# Download the CDS file
download.file(URL, destfile="bifido_cds.fa.gz")

# Decompress the file
gunzip("bifido_cds.fa.gz")

# List the files in the current directory
list.files()

```

To see the number of coding sequences in the organisms, we use the following code:

```{r}
# Load necessary library
library("seqinr")

# Reading of the uncompressed files for both the bacteria
cds <- seqinr::read.fasta("ecoli_cds.fa")
cds1 <- seqinr::read.fasta("bifido_cds.fa")

# Shows the coding sequences in E.coli and Bifidobacteriaceae
length(cds)
length(cds1)
```

A more refined code can be used to display the number of sequences in the downloaded coding sequence of both the organisms.

```{r}
# Load the necessary library
library(seqinr)

# Function to count the number of coding sequences in a fasta file using seqinr
count_CDS <- function(file) {
  # Read the fasta file
  fasta_content <- read.fasta(file, seqtype = "DNA")
  
  # The length of fasta_content gives the number of sequences (CDSs)
  num_cds <- length(fasta_content)
  
  return(num_cds)
}

# Count the number of CDS in E. coli
ecoli_cds_count <- count_CDS("ecoli_cds.fa")
cat("Number of coding sequences in Escherichia coli:", ecoli_cds_count, "\n")

# Count the number of CDS in Bifidobacteriaceae bacterium
bifido_cds_count <- count_CDS("bifido_cds.fa")
cat("Number of coding sequences in Bifidobacteriaceae bacterium:", bifido_cds_count, "\n")

```
**Code Explanation:**

- The seqinr library provides tools for biological sequence analysis, such as reading, writing, and manipulating sequence data in various formats, including FASTA files.
- count_CDS: This function takes a FASTA file as an argument and returns the number of coding sequences (CDS) present in that file.
- read.fasta(file, seqtype = "DNA"): Reads the FASTA file specified by file. It is instructed to treat the sequences as DNA (seqtype = "DNA").
- fasta_content holds all the sequences from the file.
- length(fasta_content): This counts the number of sequences in the fasta_content list, which is equivalent to the number of CDS in the file.
- The function returns the number of sequences (CDS) found in the file.
- count_CDS("ecoli_cds.fa"): Calls the count_CDS function and passes the E. coli CDS FASTA file (ecoli_cds.fa) as the input. The result is stored in ecoli_cds_count.
- cat(): Prints a message to the console displaying the number of coding sequences in the E. coli genome.
- Similar to the previous step, this section reads the FASTA file for Bifidobacteriaceae bacterium (bifido_cds.fa), counts the CDS, and prints the result.

To create a table for the number of coding sequences, we will download a new package called "dplyr" and we use the following code:
```{r}
# Download the package
install.packages("dplyr")

# Load necessary library for data manipulation
library(dplyr)

# Create a table to compare the number of CDSs in both organisms
cds_table <- data.frame(
  Organism = c("Escherichia coli", "Bifidobacteriaceae bacterium"),
  CDS_Count = c(ecoli_cds_count, bifido_cds_count)
)

# Display the table
print(cds_table)
```

**Code Explanation:**
- install.packages("dplyr"): This command installs the dplyr package, which is a powerful tool for data manipulation in R. You only need to run this once unless the package is not already installed or needs to be updated.
- library(dplyr): Loads the dplyr library into the R session so you can use its functions. It’s a popular package for data manipulation, offering tools like filtering, selecting, grouping, and summarizing data.
- data.frame(): This function creates a data frame, which is a two-dimensional, tabular data structure in R (similar to a spreadsheet or SQL table).
 1. Organism = c("Escherichia coli", "Bifidobacteriaceae bacterium"): This creates the first column in the data frame called Organism, with the names of two organisms: Escherichia coli and Bifidobacteriaceae bacterium.
 2. CDS_Count = c(ecoli_cds_count, bifido_cds_count): This creates the second column called CDS_Count, which stores the number of coding sequences (CDS) in each organism. The values come from the previously calculated variables ecoli_cds_count and bifido_cds_count, which hold the CDS counts for Escherichia coli and Bifidobacteriaceae bacterium, respectively.
- print(cds_table): Displays the contents of the cds_table data frame in the console. This allows you to see a side-by-side comparison of the number of CDSs in the two organisms.

The difference between the 2 organisms is clear in terms of number of sequences. E. coli. has more number of coding sequences than Bifidobacteriaceae bacterium. This can also be seen using the following code:
```{r}
# Describe the difference between the two organisms
if (ecoli_cds_count > bifido_cds_count) {
  cat("Escherichia coli has more coding sequences (CDSs) than Bifidobacteriaceae bacterium.\n")
} else if (ecoli_cds_count < bifido_cds_count) {
  cat("Bifidobacteriaceae bacterium has more coding sequences (CDSs) than Escherichia coli.\n")
} else {
  cat("Both organisms have the same number of coding sequences (CDSs).\n")
}
```

##Step 2
Calculation of amount of coding DNA present in total for both organisms and presentation of the data in the form of a tabular column.

```{r}

#code to delegate bifido_cds.fa as cds1 and ecoli_cds.fa
cds1 <- seqinr::read.fasta("bifido_cds.fa")
cds2 <- seqinr::read.fasta("ecoli_cds.fa")

```
**Code Explanation**
The code above uses the read.fasta function from seqinr package to read the uncompressed files "bifido_cds.fa" and "ecoli_cds.fa" for both the organisms and stores it under variable names cds1 and cds2 for ease of access.

```{r}
#code to calculate the amount of coding DNA
The difference between both of the organisms is that the amount of coding DNA in "bifido_cds.fa" is more than that in "Ecoli_cds.fa"

len1 <- as.numeric(summary(cds1)[,1])
sum(len1)
len2 <- as.numeric(summary(cds2)[,1])
sum(len2)
```

**Code Explanation
cds1 and cds2 refers to the list of DNA coding sequences obtained earlier from the fasta file. The [,1] selects the first column only and the summary function extracts this data which is the length and stores it in the variables len1 and len2. The sum function calculates the total number of base pairs for len1 and len2 when applied.

```{r}
# Load necessary library for data manipulation
library(dplyr)

# Create a table to compare the number of CDSs in both organisms
cds_table <- data.frame(
  Organism = c("Escherichia coli", "Bifidobacteriaceae bacterium"),
  CDS_Count = c(ecoli_cds_count, bifido_cds_count)
)

# Display the table
print(cds_table)
```

**Code Explanation**
This code creates a data frame called "cds_table" to compare the coding sequences between the organisms. The library(dplyr) loads the dplyr package for potential data manipulation and a table is created using the values stored in the variables "ecoli_cds_count" and "bifido_cds_count". 
the data.frame function organises the name in one column and the cds counts in another. The print function displays the table.


